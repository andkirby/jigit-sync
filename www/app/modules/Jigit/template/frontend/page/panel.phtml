<?php /** @var $this Jigit\Block\Panel */
$this->setData('height', 30);
$this->setData('margin', 2);
$this->setData('padding', 5);
?>
<script type="text/javascript">
    webix.ready(function () {
        var form = $$('jigit_panel');
        form.elements.button_submit.attachEvent('onItemClick', function () {
            var values = form.getValues({disabled: false});
            if (!form.validate()) {
                JIGIT.Form.showInvalidFormMessage();
                return;
            }
            if (values.action == 'report') {
                webix.ajax().post(
                    '<?php echo $this->getUrl('*/*/getPanelOptions'); ?>',
                    values, [
                        JIGIT.Form.defaultRequestCallback,
                        function (text, xml, xhr) {
                            var response = xml.json();
                            if (!response.has_errors) {
                                console.info('Success');
                            }
                        }
                    ]
                );
                return;
            }

            //make request
            webix.ajax().post(
                '<?php echo $this->getUrl('*/*/post'); ?>',
                values, [
                    JIGIT.Form.defaultRequestCallback,
                    function (text, xml, xhr) {
                        var response = xml.json();
                        if (!response.has_errors) {
                            console.info('Success');
                        }
                    }
                ]
            );
        });
    });
</script>
